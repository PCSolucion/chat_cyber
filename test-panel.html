<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Test Panel - Cyberpunk Chat Widget</title>
    <link rel="icon" type="image/png" href="img/netrunner.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Reusa los estilos del widget principal -->
    <link rel="stylesheet" href="css/bundle.css">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <!-- Reusa los estilos del widget principal -->
    <link rel="stylesheet" href="css/bundle.css">
    <link rel="stylesheet" href="css/test-panel.css">
</head>
<body>
    <!-- Widget Preview -->
    <div class="widget-container" id="preview-container">
        <span class="widget-label">LIVE_PREVIEW // 2K (1440p)</span>
        <iframe id="widget-frame" src="index.html"></iframe>
        
        <!-- Cyberpunk Terminal Overlay -->
        <div class="cyber-terminal">
            <div class="terminal-header">
                <span class="blink">>></span> SYSTEM_LOGS // STREAM
            </div>
            <div id="panel-logs">
                <div class="log-entry system">> _init_console... OK</div>
                <div class="log-entry system">> _waiting_for_input...</div>
            </div>
        </div>
    </div>

    <!-- Test Panel -->
    <div id="test-panel">
        <h3 class="panel-title">SYSTEM_CONSOLE</h3>

        <div class="panel-scroll-area">
            <!-- Global Toggles -->
            <div class="panel-section">
                <div class="control-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="keep-visible-checkbox">
                        OVR_VISIBILITY_LOCK
                    </label>
                </div>
            </div>

            <!-- Simulation Controls -->
            <div class="panel-section">
                <label class="section-label">TRAFFIC_SIM</label>
                <div class="button-row">
                    <button id="sim-start-btn" onclick="toggleAutoChat()" class="btn btn--full btn--cyan" style="text-align: center;">‚ñ∂ START_AUTO_CHAT</button>
                </div>
                <div id="sim-stats" style="font-size: 9px; color: #555; text-align: center; margin-top: 6px; display: none; font-family: 'Share Tech Mono';">
                    PACKETS: <span id="sim-count" style="color: var(--cyan);">0</span> // STATUS: <span style="color: #00ff64;">ACTIVE</span>
                </div>
            </div>

            <!-- Environment Selection -->
            <div class="panel-section">
                <label class="section-label">ENVIRONMENT</label>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                    <button onclick="changeBG('img/fondo pruebas.webp')" class="btn btn--full" style="font-size: 9px; text-align: center;">BG_1</button>
                    <button onclick="changeBG('img/fondo pruebas2.png')" class="btn btn--full" style="font-size: 9px; text-align: center;">BG_2</button>
                </div>
            </div>

            <!-- Manual Triggering -->
            <div class="panel-section">
                <label class="section-label">MESSAGE_INJECTOR</label>
                
                <label class="panel-label">Input Buffer (Text to send):</label>
                <input type="text" id="test-message" value="ACCESS_GRANTED: Initializing test protocol..." class="panel-input">
                
                <div class="tag-selector">
                    <label class="tag-opt mod"><input type="checkbox" id="mod-toggle"> MOD</label>
                    <label class="tag-opt vip"><input type="checkbox" id="vip-toggle"> VIP</label>
                    <label class="tag-opt sub"><input type="checkbox" id="sub-toggle"> SUB</label>
                </div>

                <div class="button-list" style="margin-top: 10px;">
                    <button id="broadcaster-btn" onclick="testUser('liiukiin')" class="btn btn--purple btn--full" style="text-align: center;">üëë BROADCASTER</button>
                    <div class="button-row" style="margin-top: 5px;">
                        <input type="text" id="custom-user" placeholder="USER_ID..." class="panel-input" style="flex: 1;">
                        <button onclick="testUser(document.getElementById('custom-user').value)" class="btn btn--cyan" style="min-width: 60px;">SEND</button>
                    </div>
                </div>
            </div>

            <!-- System Features -->
            <div class="panel-section">
                <label class="section-label">SYSTEM_TESTS</label>
                <div class="button-row">
                    <input type="number" id="streak-days" value="5" min="1" class="panel-input" style="flex: 1; color: var(--gold);">
                    <button onclick="testStreak(document.getElementById('streak-days').value)" class="btn btn--gold">SET_STREAK</button>
                </div>
                <div style="margin-top: 10px; display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                    <button onclick="callWidgetFunction('gist.testConnection')" class="btn btn--top1 btn--full" style="font-size: 9px;">üì° GIST</button>
                    <button onclick="callWidgetFunction('achievements.test')" class="btn btn--top btn--full" style="font-size: 9px;">üèÜ ACHV</button>
                </div>
                <button onclick="testLevelUp()" class="btn btn--full btn--purple" style="margin-top: 8px; text-align: center;">üöÄ TEST_LEVEL_UP</button>
            </div>

            <!-- Data & Export -->
            <div class="panel-section">
                <label class="section-label">DATA_MGMT</label>
                <button onclick="callWidgetFunction('xp.exportData')" class="btn btn--full btn--green" style="text-align: center;">EXPORT_BACKUP_JSON</button>
            </div>
        </div>

        <div class="panel-footer">
            PROTOCOL_V2 // IDLE
        </div>
    </div>

    <script src="js/test-panel.js"></script>
</body>

</html>